<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>–ò–≥—Ä–∞ –õ–µ—Å—Ç–Ω–∏—Ü–∞</title>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet" />
    <meta
      name="description"
      content="–ò–≥—Ä–∞ –õ–µ—Å—Ç–Ω–∏—Ü–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö: –í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ –∏ —É–∑–Ω–∞–π—Ç–µ —Å–≤–æ—é —Å—É–¥—å–±—É! –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –≤—Å–µ—Ö —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤, –≤–∫–ª—é—á–∞—è iPhone SE. –ë—ã—Å—Ç—Ä–∞—è –∏ –≤–µ—Å–µ–ª–∞—è –≤–µ–±-–∏–≥—Ä–∞ –Ω–∞ —É–¥–∞—á—É." />
    <meta
      name="keywords"
      content="–ò–≥—Ä–∞ –õ–µ—Å—Ç–Ω–∏—Ü–∞, –º–æ–±–∏–ª—å–Ω–∞—è –∏–≥—Ä–∞, –≤–µ–±-–∏–≥—Ä–∞, –ª–æ—Ç–µ—Ä–µ—è –ª–µ—Å—Ç–Ω–∏—Ü–∞, –∏–≥—Ä–∞ –Ω–∞ —É–¥–∞—á—É, –º–∏–Ω–∏-–∏–≥—Ä–∞, –∫–∞–∑—É–∞–ª—å–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è, –∏–≥—Ä–∞ –¥–ª—è iPhone, iPhone SE, –ª–µ—Å—Ç–Ω–∏—Ü–∞, —Å–ª—É—á–∞–π–Ω–∞—è –∏–≥—Ä–∞, –±—Ä–∞—É–∑–µ—Ä–Ω–∞—è –∏–≥—Ä–∞, —Ç–µ—Å—Ç —É–¥–∞—á–∏, –≤—ã–±–æ—Ä —á–∏—Å–ª–∞, —Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞, HTML5" />
    <meta name="author" content="Itagi" />
    <meta name="robots" content="index, follow" />

    <meta property="og:title" content="–ò–≥—Ä–∞ –õ–µ—Å—Ç–Ω–∏—Ü–∞ ‚Äì –ò–≥—Ä–∞ –Ω–∞ —É–¥–∞—á—É –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö" />
    <meta
      property="og:description"
      content="–í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ –∏ —É–∑–Ω–∞–π—Ç–µ —Å–≤–æ—é —Å—É–¥—å–±—É –Ω–∞ –ª–µ—Å—Ç–Ω–∏—Ü–µ. –í–µ—Å–µ–ª–æ –∏ –±—ã—Å—Ç—Ä–æ, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö!" />
    <meta property="og:image" content="https://emfls.github.io/thumbnail.png" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://emfls.github.io/ru/game/LadderGame" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="–ò–≥—Ä–∞ –õ–µ—Å—Ç–Ω–∏—Ü–∞ ‚Äì –ò–≥—Ä–∞ –Ω–∞ —É–¥–∞—á—É –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö" />
    <meta
      name="twitter:description"
      content="–ò–≥—Ä–∞ –õ–µ—Å—Ç–Ω–∏—Ü–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö: –í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ –∏ —É–∑–Ω–∞–π—Ç–µ —Å–≤–æ—é —Å—É–¥—å–±—É!" />
    <meta name="twitter:image" content="https://emfls.github.io/thumbnail.png" />

    <link rel="canonical" href="https://emfls.github.io/ru/game/LadderGame" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QP5Q67GE5B"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-QP5Q67GE5B");
    </script>
    <script
      async
      src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8830524482034754"
      crossorigin="anonymous"></script>
<link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="gameWrap">
      <h1>–ò–≥—Ä–∞ –õ–µ—Å—Ç–Ω–∏—Ü–∞</h1>
      <div class="desc">–í—ã–±–µ—Ä–∏—Ç–µ —á–∏—Å–ª–æ –∏ —É–∑–Ω–∞–π—Ç–µ —Å–≤–æ—é —Å—É–¥—å–±—É –Ω–∞ –ª–µ—Å—Ç–Ω–∏—Ü–µ!</div>
      <div id="ladderBox">
        <div id="topChoices"></div>
        <canvas id="ladderCanvas" width="200" height="340"></canvas>
        <canvas
          id="ladderMask"
          width="200"
          height="340"
          style="
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
            display: none;
            pointer-events: none;
          "></canvas>
      </div>
      <div id="resultMsg"></div>
      <div id="btnRow">
        <button class="btn" id="startBtn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        <button class="btn hide" id="retryBtn">–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å</button>
        <button class="btn" id="shareBtn">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
        <button class="btn" id="otherBtn">–î—Ä—É–≥–∏–µ –∏–≥—Ä—ã</button>
      </div>
    </div>
    <script>
      const ladderCols = 4;
      let wave = 1;
      let ladder, playing, busy, result, showTimeout;
      const canvas = document.getElementById("ladderCanvas");
      const ctx = canvas.getContext("2d");
      const maskCanvas = document.getElementById("ladderMask");
      const maskCtx = maskCanvas.getContext("2d");
      const topChoices = document.getElementById("topChoices");
      const resultMsg = document.getElementById("resultMsg");
      const startBtn = document.getElementById("startBtn");
      const retryBtn = document.getElementById("retryBtn");
      const shareBtn = document.getElementById("shareBtn");
      const otherBtn = document.getElementById("otherBtn");

      // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ X –∫–æ–ª–æ–Ω–Ω —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ç—Å—Ç—É–ø–∞–º
      function getX(idx) {
        const sidePadding = 18;
        return sidePadding + idx * ((canvas.width - sidePadding * 2) / (ladderCols - 1));
      }

      function getWaveConfig(wave) {
        const minGameOver = Math.min(3, Math.floor((wave - 1) / 3));
        const gameOver = Math.min(ladderCols, 1 + minGameOver);
        const levelUp = ladderCols - gameOver;
        const hLines = Math.min(10, 3 + Math.floor(wave * 1.1));
        return { levelUp, gameOver, hLines };
      }

      function genLadder(wave) {
        const cfg = getWaveConfig(wave);
        let arr = Array(cfg.levelUp).fill("LEVELUP").concat(Array(cfg.gameOver).fill("GAMEOVER"));
        arr = arr.sort(() => Math.random() - 0.5);
        let lines = [];
        const topMargin = 38;
        const bottomMargin = 56;
        for (let i = 0; i < cfg.hLines; ++i) {
          let pos, y;
          do {
            pos = Math.floor(Math.random() * (ladderCols - 1));
            y = Math.round(topMargin + (i * (canvas.height - topMargin - bottomMargin)) / (cfg.hLines - 1));
          } while (lines.length && Math.abs(lines[lines.length - 1].pos - pos) < 1);
          lines.push({ y, pos });
        }
        return { lines, ends: arr, cfg };
      }

      function drawLadder(ladder, showEnds = true, highlightPath = null) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#e8f2fe";
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        for (let i = 0; i < ladderCols; i++) {
          ctx.beginPath();
          ctx.strokeStyle = "#3272ed";
          ctx.lineWidth = 3.2;
          ctx.moveTo(getX(i), 32);
          ctx.lineTo(getX(i), canvas.height - 42);
          ctx.stroke();
        }
        for (let l of ladder.lines) {
          const x = getX(l.pos);
          ctx.beginPath();
          ctx.strokeStyle = "#f3a922";
          ctx.lineWidth = 5.1;
          ctx.moveTo(x, l.y);
          ctx.lineTo(x + (canvas.width - 36) / (ladderCols - 1), l.y);
          ctx.stroke();
        }
        if (highlightPath) {
          ctx.save();
          ctx.strokeStyle = "#6afc91";
          ctx.lineWidth = 8;
          ctx.shadowColor = "#6afc91cc";
          ctx.shadowBlur = 11;
          ctx.beginPath();
          let { path } = highlightPath;
          ctx.moveTo(path[0].x, path[0].y);
          for (let pt of path) ctx.lineTo(pt.x, pt.y);
          ctx.stroke();
          ctx.restore();
        }
        if (showEnds) {
          for (let i = 0; i < ladderCols; i++) {
            ctx.beginPath();
            ctx.arc(getX(i), canvas.height - 30, 16, 0, 2 * Math.PI);
            ctx.fillStyle = ladder.ends[i] === "LEVELUP" ? "#b2ffd6" : "#ffb6b6";
            ctx.shadowColor = ladder.ends[i] === "LEVELUP" ? "#6afc9170" : "#e97e7e70";
            ctx.shadowBlur = 2;
            ctx.fill();
            ctx.shadowBlur = 0;
            ctx.fillStyle = ladder.ends[i] === "LEVELUP" ? "#10b369" : "#b91414";
            ctx.font = "bold 1.05rem Jua,sans-serif";
            ctx.textAlign = "center";
            ctx.fillText(ladder.ends[i] === "LEVELUP" ? "Lv‚Üë" : "X", getX(i), canvas.height - 24);
          }
        }
      }

      function renderTopChoices() {
        topChoices.innerHTML = "";
        if (!playing || busy) return;
        for (let i = 0; i < ladderCols; i++) {
          let btn = document.createElement("button");
          btn.className = "numBtn";
          btn.innerText = i + 1;
          btn.style.left = `${(getX(i) / canvas.width) * 100}%`;
          btn.onclick = () => chooseStart(i);
          topChoices.appendChild(btn);
        }
      }

      function showMask(show) {
        maskCtx.clearRect(0, 0, maskCanvas.width, maskCanvas.height);
        maskCanvas.style.display = show ? "block" : "none";
        if (show) {
          maskCtx.globalAlpha = 1.0;
          maskCtx.fillStyle = "#e8f2fe";
          maskCtx.fillRect(0, 32, maskCanvas.width, maskCanvas.height - 68);
        }
      }

      function startWave() {
        playing = true;
        busy = false;
        result = null;
        ladder = genLadder(wave);
        resultMsg.innerText = "";
        drawLadder(ladder, true);
        showMask(false);
        renderTopChoices();
        showTimeout && clearTimeout(showTimeout);
        showTimeout = setTimeout(() => {
          showMask(true);
        }, 2200);
      }

      function chooseStart(idx) {
        if (!playing || busy) return;
        busy = true;
        showMask(true);
        const path = calcPath(idx, ladder);
        let t = 0,
          animLen = path.length,
          animId;
        function animatePath() {
          if (t < animLen) {
            drawLadder(ladder, true, { path: path.slice(0, t + 1) });
            showMask(true);
            t++;
            animId = requestAnimationFrame(animatePath);
          } else {
            drawLadder(ladder, true, { path: path });
            showMask(false);
            setTimeout(() => {
              let endIdx = path[path.length - 1].col;
              let endRes = ladder.ends[endIdx];
              resultMsg.innerHTML = endRes === "LEVELUP"
                ? "üéâ <b>–ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è!</b> –°–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ ‚Üí"
                : "üíÄ <b>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</b>";
              renderTopChoices();
              playing = endRes === "LEVELUP";
              busy = false;
              if (endRes === "LEVELUP") {
                wave++;
                setTimeout(startWave, 1000);
              } else {
                retryBtn.classList.remove("hide");
                startBtn.classList.add("hide");
              }
            }, 420);
          }
        }
        animatePath();
      }

      function calcPath(startIdx, ladder) {
        let path = [{ x: getX(startIdx), y: 32, col: startIdx }];
        let col = startIdx;
        for (let l of ladder.lines) {
          path.push({ x: getX(col), y: l.y, col });
          if (col < ladderCols - 1 && l.pos === col) {
            col++;
            path.push({ x: getX(col), y: l.y, col });
          } else if (col > 0 && l.pos === col - 1) {
            col--;
            path.push({ x: getX(col), y: l.y, col });
          }
        }
        path.push({ x: getX(col), y: canvas.height - 42, col });
        return path;
      }

      startBtn.onclick = function () {
        wave = 1;
        retryBtn.classList.add("hide");
        startBtn.classList.add("hide");
        startWave();
      };
      retryBtn.onclick = function () {
        wave = 1;
        retryBtn.classList.add("hide");
        startBtn.classList.add("hide");
        startWave();
      };
      shareBtn.onclick = function () {
        const shareUrl = window.location.href;
        if (navigator.share) {
          navigator.share({ title: document.title, url: shareUrl });
        } else {
          window.prompt("–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç—É —Å—Å—ã–ª–∫—É, —á—Ç–æ–±—ã –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –¥—Ä—É–∑—å—è–º–∏!", shareUrl);
        }
      };
      otherBtn.onclick = function () {
        window.location.href = "kor/game/";
      };

      function resetUI() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        maskCtx.clearRect(0, 0, maskCanvas.width, maskCanvas.height);
        showMask(false);
        resultMsg.innerText = "";
        topChoices.innerHTML = "";
        startBtn.classList.remove("hide");
        retryBtn.classList.add("hide");
      }
      resetUI();

      function resizeAll() {
        const ladderBox = document.getElementById("ladderBox");
        let w = ladderBox.clientWidth;
        canvas.width = w;
        canvas.height = ladderBox.clientHeight;
        maskCanvas.width = w;
        maskCanvas.height = ladderBox.clientHeight;
        if (ladder) {
          drawLadder(ladder, true);
          renderTopChoices();
          showMask(maskCanvas.style.display === "block");
        }
      }
      window.addEventListener("resize", resizeAll);
      setTimeout(resizeAll, 100);
    </script>
    <section
      style="
        width: 80%;
        max-width: 420px;
        margin: 60px auto;
        padding: 20px;
        font-family: 'Segoe UI', sans-serif;
        background: #f0f8ff;
        color: #2d3436;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        line-height: 1.6;
        font-size: 14px;
      ">
      <h2 style="font-size: 20px; margin-bottom: 1rem; color: #1e70c2">‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)</h2>

      <div style="margin-bottom: 1rem">
        <strong>–í1. –ö–∞–∫ –∏–≥—Ä–∞—Ç—å –≤ –ò–≥—Ä—É –õ–µ—Å—Ç–Ω–∏—Ü–∞?</strong><br />
        –û. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ —á–∏—Å–ª–æ –≤–≤–µ—Ä—Ö—É, —á—Ç–æ–±—ã —Å–ø—É—Å—Ç–∏—Ç—å—Å—è –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ –∏ —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
      </div>

      <div style="margin-bottom: 1rem">
        <strong>–í2. –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç "–ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è"?</strong><br />
        –û. –í—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏ —Ç–µ–∫—É—â—É—é –≤–æ–ª–Ω—É –∏ –ø–µ—Ä–µ–π–¥–µ—Ç–µ –∫ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–º—É —Ä–∞—É–Ω–¥—É.
      </div>

      <div style="margin-bottom: 1rem">
        <strong>–í3. –ö–æ–≥–¥–∞ –∏–≥—Ä–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è?</strong><br />
        –û. –ò–≥—Ä–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –≤–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç <strong>–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞ (X)</strong>.
      </div>

      <div style="margin-bottom: 1rem">
        <strong>–í4. –≠—Ç–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–ª—É—á–∞–π–Ω–æ?</strong><br />
        –û. –î–∞! –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–µ–º–µ—à–∏–≤–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –∫–∞–∂–¥—ã–π —Ä–∞—É–Ω–¥.
      </div>

      <div style="margin-bottom: 1rem">
        <strong>–í5. –ö–∞–∫ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å?</strong><br />
        –û. –ù–∞–∂–º–∏—Ç–µ <strong>–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å</strong>, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ —Å –≤–æ–ª–Ω—ã 1.
      </div>

      <div style="margin-bottom: 1rem">
        <strong>–í6. –ú–æ–≥—É –ª–∏ —è –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–≥—Ä–æ–π?</strong><br />
        –û. –ö–æ–Ω–µ—á–Ω–æ! –ù–∞–∂–º–∏—Ç–µ <strong>–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</strong>, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ–±–º–µ–Ω–∞ –≤–∞—à–µ–≥–æ –º–æ–±–∏–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
      </div>
    </section>
  </body>
</html>
