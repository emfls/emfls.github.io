<!doctype html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            name="description"
            content="–ò–≥—Ä–∞–π—Ç–µ –≤ –ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ –æ–Ω–ª–∞–π–Ω –±–µ—Å–ø–ª–∞—Ç–Ω–æ! –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å —ç—Ç–æ–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–π –∏–≥—Ä–æ–π –¥–ª—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤ —Å –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º. –ü—Ä–æ—Å—Ç–æ, –±—ã—Å—Ç—Ä–æ –∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ —Å –º–æ–±–∏–ª—å–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏."
        />
        <meta
            name="keywords"
            content="–ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥, –∏–≥—Ä–∞ —á–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥, –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–∞, –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –∏–≥—Ä–∞, –¥–≤–∞ –∏–≥—Ä–æ–∫–∞, –ø—Ä–æ—Ç–∏–≤ –ò–ò, —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞, –Ω–∞—Å—Ç–æ–ª—å–Ω–∞—è –∏–≥—Ä–∞, –±—Ä–∞—É–∑–µ—Ä, –º–æ–±–∏–ª—å–Ω—ã–π, –≥–æ–ª–æ–≤–æ–ª–æ–º–∫–∞, –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è"
        />
        <meta name="author" content="Itagi" />
        <meta name="robots" content="index, follow" />

        <link rel="canonical" href="https://emfls.github.io/ru/game/ConnectFour" />

        <meta property="og:title" content="–ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ ‚Äì –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–∞ –¥–ª—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤!" />
        <meta
            property="og:description"
            content="–ò–≥—Ä–∞–π—Ç–µ –≤ –ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ! –°—Ä–∞–∂–∞–π—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ –ò–ò –∏ —Å–æ–±–µ—Ä–∏—Ç–µ —á–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏, –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –∏–ª–∏ –¥–∏–∞–≥–æ–Ω–∞–ª–∏, —á—Ç–æ–±—ã –≤—ã–∏–≥—Ä–∞—Ç—å."
        />
        <meta property="og:image" content="https://emfls.github.io/thumbnail.png" />
        <meta property="og:url" content="https://emfls.github.io/ru/game/ConnectFour" />
        <meta property="og:type" content="website" />

        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content="–ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ ‚Äì –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –æ–Ω–ª–∞–π–Ω –∏–≥—Ä–∞ –¥–ª—è –¥–≤—É—Ö –∏–≥—Ä–æ–∫–æ–≤!" />
        <meta
            name="twitter:description"
            content="–ò–≥—Ä–∞–π—Ç–µ –≤ –ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ! –°—Ä–∞–∂–∞–π—Ç–µ—Å—å —Å –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ –ò–ò –∏ —Å–æ–±–µ—Ä–∏—Ç–µ —á–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏, –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –∏–ª–∏ –¥–∏–∞–≥–æ–Ω–∞–ª–∏, —á—Ç–æ–±—ã –≤—ã–∏–≥—Ä–∞—Ç—å."
        />
        <meta name="twitter:image" content="https://emfls.github.io/thumbnail.png" />
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-QP5Q67GE5B"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());

            gtag("config", "G-QP5Q67GE5B");
        </script>
        <script
            async
            src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8830524482034754"
            crossorigin="anonymous"
        ></script>
        <link rel="stylesheet" href="style.css" />
        <title>–ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥</title>
    </head>

    <body>
        <div id="wrapper">
            <h1>–ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥</h1>
            <div class="desc">–°–æ–±–µ—Ä–∏—Ç–µ —á–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏, –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –∏–ª–∏ –¥–∏–∞–≥–æ–Ω–∞–ª–∏, —á—Ç–æ–±—ã –≤—ã–∏–≥—Ä–∞—Ç—å!</div>
            <div id="modeSel">
                <button class="modebtn active" id="mode2p" onclick="setMode('2p')">2 –∏–≥—Ä–æ–∫–∞</button>
                <button class="modebtn" id="modeai" onclick="setMode('ai')">–ü—Ä–æ—Ç–∏–≤ –ò–ò</button>
            </div>
            <div id="turn"></div>
            <div id="board"></div>
            <div id="overMsg"></div>
            <div class="btns" id="gameBtns" style="display: none">
                <button class="btn" onclick="restart()">–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å</button>
                <button class="btn" onclick="share()">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
            </div>
            <a id="otherGames" href="../" style="margin-top: 22px">–î—Ä—É–≥–∏–µ –∏–≥—Ä—ã</a>
        </div>
        <script>
            // –û—Ç–∫–ª—é—á–∏—Ç—å –≤—ã–¥–µ–ª–µ–Ω–∏–µ/–ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º
            document.addEventListener(
                "touchmove",
                (e) => {
                    if (e.scale !== 1) e.preventDefault();
                },
                {
                    passive: false
                }
            );
            document.body.addEventListener("dragstart", (e) => e.preventDefault());
            document.body.addEventListener("selectstart", (e) => e.preventDefault());

            const ROWS = 6,
                  COLS = 7;
            let board, turn, over, winner;
            let mode = "2p"; // "2p" –∏–ª–∏ "ai"
            const COLORS = ["üîµ", "üü°"];

            function emptyBoard() {
                return Array.from(
                    { length: ROWS },
                    () => Array(COLS).fill(null)
                );
            }

            function render() {
                const boardDiv = document.getElementById("board");
                boardDiv.innerHTML = "";
                for (let r = 0; r < ROWS; r++) {
                    for (let c = 0; c < COLS; c++) {
                        let cell = document.createElement("div");
                        cell.className = "cell" + (board[r][c] !== null ? " filled" : "");
                        cell.dataset.col = c;
                        cell.style.pointerEvents = over ? "none" : "";
                        cell.innerHTML = board[r][c] !== null ? COLORS[board[r][c]] : "";
                        cell.onclick = () => {
                            if (over) return;
                            if (mode === "ai" && turn === 1) return; // –ù–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å, –∫–æ–≥–¥–∞ —Ö–æ–¥ –ò–ò
                            if (playerMove(c)) {
                                render();
                                if (mode === "ai" && !over && turn === 1) {
                                    setTimeout(aiMove, 350); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è —Ö–æ–¥–∞ –ò–ò
                                }
                            }
                        };
                        boardDiv.appendChild(cell);
                    }
                }
                let msg = "";
                if (!over) {
                    msg = COLORS[turn]
                        + (mode === "ai" ? (turn === 0 ? " (–í—ã)" : " (–ò–ò)") : "")
                        + " –≤–∞—à —Ö–æ–¥";
                } else if (winner !== null) {
                    msg = COLORS[winner]
                        + (mode === "ai" ? (winner === 0 ? " (–í—ã)" : " (–ò–ò)") : "")
                        + " –ø–æ–±–µ–¥–∏–ª!";
                } else {
                    msg = "–ù–∏—á—å—è!";
                }
                document.getElementById("turn").textContent = msg;
                document.getElementById("overMsg").textContent = over && winner !== null
                    ? msg
                    : over
                        ? "–ù–∏—á—å—è!"
                        : "";
                document.getElementById("gameBtns").style.display = over ? "flex" : "none";
                document.getElementById("mode2p").classList.toggle("active", mode === "2p");
                document.getElementById("modeai").classList.toggle("active", mode === "ai");
            }

            // –°–¥–µ–ª–∞—Ç—å —Ö–æ–¥ –∏–≥—Ä–æ–∫–∞ –∏–ª–∏ 2P (–æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
            function playerMove(col) {
                if (over) return false;
                for (let r = ROWS - 1; r >= 0; r--) {
                    if (board[r][col] === null) {
                        board[r][col] = turn;
                        // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–±–µ–¥—É/–Ω–∏—á—å—é
                        if (checkWin(r, col, turn)) {
                            over = true;
                            winner = turn;
                        } else if (board.flat().every((cell) => cell !== null)) {
                            over = true;
                            winner = null;
                        } else {
                            turn = 1 - turn;
                        }
                        return true;
                    }
                }
                return false;
            }

            // –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ò–ò –∏–ª–∏ —Å–∏–º—É–ª—è—Ü–∏–∏ (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ over/winner)
            function tryMove(col, whichTurn) {
                for (let r = ROWS - 1; r >= 0; r--) {
                    if (board[r][col] === null) {
                        board[r][col] = whichTurn;
                        return r;
                    }
                }
                return -1;
            }

            function undoMove(col) {
                for (let r = 0; r < ROWS; r++) {
                    if (board[r][col] !== null) {
                        board[r][col] = null;
                        break;
                    }
                }
            }

            function checkWin(r, c, color) {
                return (
                    count(r, c, 0, 1, color) + count(r, c, 0, -1, color) > 2 ||
                    count(r, c, 1, 0, color) + count(r, c, -1, 0, color) > 2 ||
                    count(r, c, 1, 1, color) + count(r, c, -1, -1, color) > 2 ||
                    count(r, c, 1, -1, color) + count(r, c, -1, 1, color) > 2
                );
            }

            function count(r, c, dr, dc, color) {
                let cnt = 0;
                for (let i = 1; i < 4; i++) {
                    let nr = r + dr * i,
                        nc = c + dc * i;
                    if (nr < 0 || nr >= ROWS || nc < 0 || nc >= COLS) break;
                    if (board[nr][nc] === color) cnt++;
                    else break;
                }
                return cnt;
            }

            function restart() {
                board = emptyBoard();
                turn = 0;
                over = false;
                winner = null;
                render();
            }

            function setMode(m) {
                if (mode !== m) {
                    mode = m;
                    restart();
                }
            }

            function aiMove() {
                if (over || turn !== 1) return;

                let validCols = [];
                for (let c = 0; c < COLS; c++) if (board[0][c] === null) validCols.push(c);

                // 1. –ò–ò –∏—â–µ—Ç —Ö–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—Ç –µ–º—É –≤—ã–∏–≥—Ä–∞—Ç—å
                for (let ci of validCols) {
                    let row = tryMove(ci, 1);
                    if (row !== -1 && checkWin(row, ci, 1)) {
                        undoMove(ci);
                        playerMove(ci); // –ò–ò –¥–µ–ª–∞–µ—Ç –≤—ã–∏–≥—Ä—ã—à–Ω—ã–π —Ö–æ–¥
                        render();
                        return;
                    }
                    if (row !== -1) undoMove(ci);
                }
                // 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ–±–µ–¥—ã –∏–≥—Ä–æ–∫–∞
                for (let ci of validCols) {
                    let row = tryMove(ci, 0);
                    if (row !== -1 && checkWin(row, ci, 0)) {
                        undoMove(ci);
                        playerMove(ci); // –ë–ª–æ–∫–∏—Ä—É—é—â–∏–π —Ö–æ–¥
                        render();
                        return;
                    }
                    if (row !== -1) undoMove(ci);
                }
                // 3. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ü–µ–Ω—Ç—Ä—É
                let bestCols = [3, 2, 4, 1, 5, 0, 6].filter((c) => validCols.includes(c));
                let col = bestCols.length > 0
                    ? bestCols[0]
                    : validCols[Math.floor(Math.random() * validCols.length)];
                playerMove(col);
                render();
            }

            function share() {
                const url = location.href;
                if (navigator.share) {
                    navigator.share({
                        title: "–ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥",
                        url
                    });
                } else {
                    navigator.clipboard.writeText(url);
                    alert("–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!");
                }
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            restart();
        </script>
        <section
            style="
                width: 90%;
                max-width: 420px;
                margin: 40px auto 80px auto;
                padding: 20px;
                background: #ffffff;
                border: 1px solid #ccc;
                border-radius: 12px;
                font-family: &quot;Segoe UI&quot;, sans-serif;
                font-size: 14px;
                line-height: 1.6;
                color: #2e2e2e;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            "
        >
            <h2 style="font-size: 18px; margin-bottom: 1rem; color: #365ca0">‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)</h2>

            <div style="margin-bottom: 1rem">
                <strong>–í1. –ö–∞–∫ –∏–≥—Ä–∞—Ç—å –≤ –ß–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥?</strong><br />
                –û. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–æ–ª–æ–Ω–∫—É, —á—Ç–æ–±—ã –±—Ä–æ—Å–∏—Ç—å —Ñ–∏—à–∫—É. –ò–≥—Ä–æ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–±–µ—Ä–µ—Ç —á–µ—Ç—ã—Ä–µ –≤ —Ä—è–¥ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏, –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –∏–ª–∏ –¥–∏–∞–≥–æ–Ω–∞–ª–∏, –ø–æ–±–µ–∂–¥–∞–µ—Ç.
            </div>

            <div style="margin-bottom: 1rem">
                <strong>–í2. –ö–∞–∫–∏–µ —Ä–µ–∂–∏–º—ã –∏–≥—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã?</strong><br />
                –û. –í—ã –º–æ–∂–µ—Ç–µ –≤—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º "2 –∏–≥—Ä–æ–∫–∞" –¥–ª—è –∏–≥—Ä—ã —Å –¥—Ä—É–∑—å—è–º–∏ –∏–ª–∏ —Ä–µ–∂–∏–º "–ü—Ä–æ—Ç–∏–≤ –ò–ò" –¥–ª—è –∏–≥—Ä—ã –ø—Ä–æ—Ç–∏–≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞.
            </div>

            <div style="margin-bottom: 1rem">
                <strong>–í3. –ù–∞—Å–∫–æ–ª—å–∫–æ —Å–∏–ª–µ–Ω –ò–ò?</strong><br />
                –û. –ò–ò –∏—â–µ—Ç —Ö–æ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—Ç –µ–º—É –≤—ã–∏–≥—Ä–∞—Ç—å, –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–æ–±–µ–¥—ã –∏–≥—Ä–æ–∫–∞ –∏ –æ—Ç–¥–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω—ã–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–º –∫–æ–ª–æ–Ω–∫–∞–º.
            </div>

            <div style="margin-bottom: 1rem">
                <strong>–í4. –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–∂–∏–º –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã?</strong><br />
                –û. –î–∞! –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫–∏ —Ä–µ–∂–∏–º–∞ –≤ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞, –∏ –∏–≥—Ä–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —Å –¥—Ä—É–≥–∏–º —Ä–µ–∂–∏–º–æ–º.
            </div>

            <div style="margin-bottom: 1rem">
                <strong>–í5. –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Å–ª—É—á–∞–µ –Ω–∏—á—å–µ–π?</strong><br />
                –û. –ï—Å–ª–∏ –¥–æ—Å–∫–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è, –∏–≥—Ä–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∏—á—å–µ–π, –∏ –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É.
            </div>

            <div>
                <strong>–í6. –ö–∞–∫ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∏–≥—Ä–æ–π?</strong><br />
                –û. –ü–æ—Å–ª–µ –∏–≥—Ä—ã –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è", —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –µ–µ –¥—Ä—É–∑—å—è–º.
            </div>
        </section>
    </body>
</html>
